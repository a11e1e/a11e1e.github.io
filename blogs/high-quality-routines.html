<!DOCTYPE html>
<html lang="zh">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>撰写高质量的例程 | 刘理铖</title>
    <meta name="description" content="本文是《代码大全》第六章的部分翻译。">
    <link rel="stylesheet" href="/assets/style.5ea99ec0.css">
    <link rel="modulepreload" href="/assets/Home.b2a6ef15.js">
    <link rel="modulepreload" href="/assets/app.331ecafa.js">
    <link rel="modulepreload" href="/assets/blogs_high-quality-routines.md.9c2e6d75.lean.js">
    <link rel="modulepreload" href="/assets/app.331ecafa.js">
    <meta name="twitter:title" content="撰写高质量的例程 | 刘理铖">
    <meta property="og:title" content="撰写高质量的例程 | 刘理铖">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme"><header class="nav-bar" data-v-675d8756><div class="sidebar-button" data-v-675d8756><svg class="icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z" class></path></svg></div><a class="nav-bar-title" href="/" aria-label="刘理铖, back to home" data-v-675d8756 data-v-4a583abe><!----> 刘理铖</a><div class="flex-grow" data-v-675d8756></div><div class="nav" data-v-675d8756><nav class="nav-links" data-v-675d8756 data-v-eab3edfe><!--[--><div class="item" data-v-eab3edfe><div class="nav-link" data-v-eab3edfe data-v-b8818f8c><a class="item" href="/" data-v-b8818f8c>首页 <!----></a></div></div><div class="item" data-v-eab3edfe><div class="nav-link" data-v-eab3edfe data-v-b8818f8c><a class="item active" href="/blogs/" data-v-b8818f8c>博客 <!----></a></div></div><div class="item" data-v-eab3edfe><div class="nav-link" data-v-eab3edfe data-v-b8818f8c><a class="item" href="/about/" data-v-b8818f8c>关于 <!----></a></div></div><!--]--><!----><!----></nav></div><!--[--><!--]--></header><aside class="sidebar" data-v-83e92a68><nav class="nav-links nav" data-v-83e92a68 data-v-eab3edfe><!--[--><div class="item" data-v-eab3edfe><div class="nav-link" data-v-eab3edfe data-v-b8818f8c><a class="item" href="/" data-v-b8818f8c>首页 <!----></a></div></div><div class="item" data-v-eab3edfe><div class="nav-link" data-v-eab3edfe data-v-b8818f8c><a class="item active" href="/blogs/" data-v-b8818f8c>博客 <!----></a></div></div><div class="item" data-v-eab3edfe><div class="nav-link" data-v-eab3edfe data-v-b8818f8c><a class="item" href="/about/" data-v-b8818f8c>关于 <!----></a></div></div><!--]--><!----><!----></nav><!--[--><!--]--><ul class="sidebar-links" data-v-83e92a68><!--[--><li class="sidebar-link"><a class="sidebar-link-item" href="#给我一个理由去撰写高质量的函数">给我一个理由去撰写高质量的函数</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#好的函数名">好的函数名</a><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="#描述例程所做的一切">描述例程所做的一切</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#避免使用模糊的动词">避免使用模糊的动词</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#不要加上数字来区分函数">不要加上数字来区分函数</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#函数名可以长一些">函数名可以长一些</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#用返回值来命名函数（function）">用返回值来命名函数（function）</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#用动词-名词来命名过程（procedure）">用动词+名词来命名过程（procedure）</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#正确使用反义词">正确使用反义词</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#约定一致的准则">约定一致的准则</a><!----></li></ul></li><li class="sidebar-link"><a class="sidebar-link-item" href="#一个函数应该多长？">一个函数应该多长？</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#函数的参数">函数的参数</a><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="#参数顺序">参数顺序</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#如果多个函数使用类似的参数，那么这几个参数的顺序应当相同。">如果多个函数使用类似的参数，那么这几个参数的顺序应当相同。</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#所有的参数都要被用到">所有的参数都要被用到</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#尽可能不要去更改参数">尽可能不要去更改参数</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#参数不要超过七个">参数不要超过七个</a><!----></li></ul></li><!--]--></ul><!--[--><!--]--></aside><!-- TODO: make this button accessible --><div class="sidebar-mask"></div><main class="page" data-v-7eddb2c4><div class="container" data-v-7eddb2c4><!--[--><!--]--><div style="position:relative;" class="content" data-v-7eddb2c4><div><h1 id="撰写高质量的例程" tabindex="-1">撰写高质量的例程 <a class="header-anchor" href="#撰写高质量的例程" aria-hidden="true">#</a></h1><p>什么是例程？例程是为了某一单一目的所调用的方法。在大部分语言，包括 JavaScript / C++ 中就是一个函数。所以本文几乎可以等同于「如何撰写高质量的函数」？下文我会用「函数」代替「例程」，因为函数听上去更加亲近。</p><h2 id="给我一个理由去撰写高质量的函数" tabindex="-1">给我一个理由去撰写高质量的函数 <a class="header-anchor" href="#给我一个理由去撰写高质量的函数" aria-hidden="true">#</a></h2><p>我认为两点就够了：</p><ul><li>减少复杂性</li><li>代码复用</li></ul><p>书中还介绍了诸如：</p><ul><li>隐藏指针操作</li><li>简化测试</li><li>提升性能</li><li>...</li></ul><p>这些都是理由，但我认为前两点就已经足够。</p><h2 id="好的函数名" tabindex="-1">好的函数名 <a class="header-anchor" href="#好的函数名" aria-hidden="true">#</a></h2><p>好的函数名应当清晰地描述函数所做的一切。该怎么做？</p><h3 id="描述例程所做的一切" tabindex="-1">描述例程所做的一切 <a class="header-anchor" href="#描述例程所做的一切" aria-hidden="true">#</a></h3><p>如果有那么一个函数，计算一些数据，并且打开一个输出用的文件。那么<code>ComputeReportTotals</code>就不够准确。而<code>ComputeReportTotalsAndOpenOutputFile</code>就太长太蠢了。如果你的函数里有副作用（在这个例子中就是打开一个输出文件），那么你就很容易得到一个很长很蠢的名字。所以你的函数尽可能不要有副作用，同时少用描述性的词语。</p><h3 id="避免使用模糊的动词" tabindex="-1">避免使用模糊的动词 <a class="header-anchor" href="#避免使用模糊的动词" aria-hidden="true">#</a></h3><p>反面教材：</p><ul><li><code>HandleCalculation</code></li><li><code>PerformServices</code></li><li><code>OutputUser</code></li><li><code>ProcessInput</code></li></ul><p>但“handle”有时候是个例外。对于事件处理函数来说，偶尔使用也无可厚非。</p><p>有时候，你的函数写的很好，但只是名字不好。而有时候你的函数本身就做了一件很模糊的事情，这就说明你可能需要重构一下这个函数，使之具有更强的目的性。</p><h3 id="不要加上数字来区分函数" tabindex="-1">不要加上数字来区分函数 <a class="header-anchor" href="#不要加上数字来区分函数" aria-hidden="true">#</a></h3><ul><li><code>OutputUser</code></li><li><code>OutputUser1</code></li><li><code>OutputUser2</code></li></ul><p>看着不觉得恶心么？</p><h3 id="函数名可以长一些" tabindex="-1">函数名可以长一些 <a class="header-anchor" href="#函数名可以长一些" aria-hidden="true">#</a></h3><p>研究表示最好的函数名应该在<strong>9-15</strong>个字符之间。函数名和变量名不一样，可以长一点。</p><h3 id="用返回值来命名函数（function）" tabindex="-1">用返回值来命名函数（function） <a class="header-anchor" href="#用返回值来命名函数（function）" aria-hidden="true">#</a></h3><p>如果一个函数有返回值，那么应该用返回值来命名函数。</p><ul><li><code>customerId.Next()</code></li><li><code>pen.CurrentColor()</code></li><li><code>printer.IsReady()</code></li></ul><p>就是一些好例子</p><h3 id="用动词-名词来命名过程（procedure）" tabindex="-1">用动词+名词来命名过程（procedure） <a class="header-anchor" href="#用动词-名词来命名过程（procedure）" aria-hidden="true">#</a></h3><p>如果一个函数没有返回值，那么应该用动词+名词来命名。</p><ul><li><code>PrintDocument</code></li><li><code>checkOrderInfo</code></li></ul><p>就不错。</p><p>如果这个函数是一个类方法，有时候就不需要名词，直接动词就好了。</p><ul><li><code>document.Print</code></li><li><code>orderInfo.Check</code></li></ul><h3 id="正确使用反义词" tabindex="-1">正确使用反义词 <a class="header-anchor" href="#正确使用反义词" aria-hidden="true">#</a></h3><p>书中举了很多例子</p><ul><li>add / remove</li><li>lock / unlock</li><li>show / hide</li><li>source / target</li></ul><p>不一而足。</p><h3 id="约定一致的准则" tabindex="-1">约定一致的准则 <a class="header-anchor" href="#约定一致的准则" aria-hidden="true">#</a></h3><p>比如同样获取用户 id</p><ul><li><code>employee.id.Get()</code></li><li><code>dependent.GetId()</code></li><li><code>candidate.id()</code></li></ul><p>这就看起来很杂乱。应当规定好只使用一种方式获取 id。</p><h2 id="一个函数应该多长？" tabindex="-1">一个函数应该多长？ <a class="header-anchor" href="#一个函数应该多长？" aria-hidden="true">#</a></h2><p>这个问题没有很明确的回答。</p><p>有种说法是，一个函数应该能用一个屏幕 🖥 看完。或者，用两张纸就能打印完。根据这些说法，大概 50 - 150 行是个合理范围。</p><p>书中还介绍了很多研究。最终给出了一个结论————不<strong>算注释的话，超过两百行的函数可能就需要小心了</strong>。我也赞同这个结论。</p><h2 id="函数的参数" tabindex="-1">函数的参数 <a class="header-anchor" href="#函数的参数" aria-hidden="true">#</a></h2><h3 id="参数顺序" tabindex="-1">参数顺序 <a class="header-anchor" href="#参数顺序" aria-hidden="true">#</a></h3><p>参数顺序应当是</p><ul><li>输入的参数</li><li>被更改的参数</li><li>输出的参数。</li></ul><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>将参数作为返回值一般来说是 C/C++ 会做的事情，JavaScript 很少会这么做。</p></div><h3 id="如果多个函数使用类似的参数，那么这几个参数的顺序应当相同。" tabindex="-1">如果多个函数使用类似的参数，那么这几个参数的顺序应当相同。 <a class="header-anchor" href="#如果多个函数使用类似的参数，那么这几个参数的顺序应当相同。" aria-hidden="true">#</a></h3><h3 id="所有的参数都要被用到" tabindex="-1">所有的参数都要被用到 <a class="header-anchor" href="#所有的参数都要被用到" aria-hidden="true">#</a></h3><h3 id="尽可能不要去更改参数" tabindex="-1">尽可能不要去更改参数 <a class="header-anchor" href="#尽可能不要去更改参数" aria-hidden="true">#</a></h3><h3 id="参数不要超过七个" tabindex="-1">参数不要超过七个 <a class="header-anchor" href="#参数不要超过七个" aria-hidden="true">#</a></h3><p>七个数字是大部分人记忆的极限。你可以记住一个六位数，但你很难瞬间记住一个 11 位的电话号码。</p></div></div><footer class="page-footer" data-v-7eddb2c4 data-v-fb8d84c6><div class="edit" data-v-fb8d84c6><div class="edit-link" data-v-fb8d84c6 data-v-1ed99556><!----></div></div><div class="updated" data-v-fb8d84c6><!----></div></footer><!----><!--[--><!--]--></div></main></div><!----><!--]--></div>
    <script>__VP_HASH_MAP__ = JSON.parse("{\"about_index.md\":\"e1795881\",\"blogs_asynchronous-programming-in-javascript.md\":\"edb7dac7\",\"blogs_high-quality-routines.md\":\"9c2e6d75\",\"blogs_index.md\":\"8cf712e3\",\"blogs_inside-look-modern-web-browser.md\":\"2859c835\",\"blogs_javascript-modularity.md\":\"0713da6c\",\"blogs_microtask-and-macrotask.md\":\"5da012e2\",\"blogs_promise-implementation.md\":\"48729fb3\",\"blogs_this-in-javascript.md\":\"cadfa4ef\",\"index.md\":\"7d4bcd7f\"}")</script>
    <script type="module" async src="/assets/app.331ecafa.js"></script>
    
  </body>
</html>